<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>typescript 巧技 | xiujava</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="jiawen 的博客">
    
    <link rel="preload" href="/pr/assets/css/0.styles.3978be1e.css" as="style"><link rel="preload" href="/pr/assets/js/app.b34ec94f.js" as="script"><link rel="preload" href="/pr/assets/js/2.846b7fc6.js" as="script"><link rel="preload" href="/pr/assets/js/1.bc703a74.js" as="script"><link rel="preload" href="/pr/assets/js/49.4dec6231.js" as="script"><link rel="prefetch" href="/pr/assets/js/10.afb24a76.js"><link rel="prefetch" href="/pr/assets/js/11.26a4e38a.js"><link rel="prefetch" href="/pr/assets/js/12.972428b2.js"><link rel="prefetch" href="/pr/assets/js/13.363a2818.js"><link rel="prefetch" href="/pr/assets/js/14.da87bb03.js"><link rel="prefetch" href="/pr/assets/js/15.be6c279e.js"><link rel="prefetch" href="/pr/assets/js/16.5b27973e.js"><link rel="prefetch" href="/pr/assets/js/17.e9441626.js"><link rel="prefetch" href="/pr/assets/js/18.73cc4e61.js"><link rel="prefetch" href="/pr/assets/js/19.04ead57f.js"><link rel="prefetch" href="/pr/assets/js/20.a59fc3ba.js"><link rel="prefetch" href="/pr/assets/js/21.08fe35aa.js"><link rel="prefetch" href="/pr/assets/js/22.8cb9dc27.js"><link rel="prefetch" href="/pr/assets/js/23.68778ed8.js"><link rel="prefetch" href="/pr/assets/js/24.f951cc52.js"><link rel="prefetch" href="/pr/assets/js/25.bb9d1655.js"><link rel="prefetch" href="/pr/assets/js/26.23b3f76a.js"><link rel="prefetch" href="/pr/assets/js/27.190cfa57.js"><link rel="prefetch" href="/pr/assets/js/28.3e339daa.js"><link rel="prefetch" href="/pr/assets/js/29.4eb1db41.js"><link rel="prefetch" href="/pr/assets/js/3.7d9825a9.js"><link rel="prefetch" href="/pr/assets/js/30.adc68930.js"><link rel="prefetch" href="/pr/assets/js/31.7ec8bb17.js"><link rel="prefetch" href="/pr/assets/js/32.47391ccd.js"><link rel="prefetch" href="/pr/assets/js/33.ebf9af3c.js"><link rel="prefetch" href="/pr/assets/js/34.8670c25e.js"><link rel="prefetch" href="/pr/assets/js/35.8246591f.js"><link rel="prefetch" href="/pr/assets/js/36.9794f5bd.js"><link rel="prefetch" href="/pr/assets/js/37.c8fc108f.js"><link rel="prefetch" href="/pr/assets/js/38.35e310b5.js"><link rel="prefetch" href="/pr/assets/js/39.df46d84f.js"><link rel="prefetch" href="/pr/assets/js/4.1b5a2940.js"><link rel="prefetch" href="/pr/assets/js/40.4cb44a86.js"><link rel="prefetch" href="/pr/assets/js/41.165c4d4d.js"><link rel="prefetch" href="/pr/assets/js/42.6cfaf2ba.js"><link rel="prefetch" href="/pr/assets/js/43.436765f6.js"><link rel="prefetch" href="/pr/assets/js/44.1d1d3e9b.js"><link rel="prefetch" href="/pr/assets/js/45.0bccaafe.js"><link rel="prefetch" href="/pr/assets/js/46.b42902a6.js"><link rel="prefetch" href="/pr/assets/js/47.300d1ad2.js"><link rel="prefetch" href="/pr/assets/js/48.5015b80e.js"><link rel="prefetch" href="/pr/assets/js/5.0d0d8c0c.js"><link rel="prefetch" href="/pr/assets/js/50.2267cf64.js"><link rel="prefetch" href="/pr/assets/js/51.7bdd1e94.js"><link rel="prefetch" href="/pr/assets/js/52.9da5a600.js"><link rel="prefetch" href="/pr/assets/js/53.089a5dc4.js"><link rel="prefetch" href="/pr/assets/js/54.34970eb3.js"><link rel="prefetch" href="/pr/assets/js/55.6e970c0f.js"><link rel="prefetch" href="/pr/assets/js/56.fe35ec84.js"><link rel="prefetch" href="/pr/assets/js/57.00921405.js"><link rel="prefetch" href="/pr/assets/js/58.0b9ba301.js"><link rel="prefetch" href="/pr/assets/js/59.1a42c7c8.js"><link rel="prefetch" href="/pr/assets/js/6.ec95ead8.js"><link rel="prefetch" href="/pr/assets/js/60.0523783a.js"><link rel="prefetch" href="/pr/assets/js/7.aa392645.js"><link rel="prefetch" href="/pr/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/pr/assets/css/0.styles.3978be1e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/pr/" class="home-link router-link-active"><!----> <span class="site-name">xiujava</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/pr/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://www.yuque.com/xiwen-bxuha/pr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  yuque
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/javaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/pr/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://www.yuque.com/xiwen-bxuha/pr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  yuque
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/javaxiu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NLP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>低代码系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>技术分享</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pr/pr/tech/scroll-bar.html" class="sidebar-link">双滚动条的滚动逻辑</a></li><li><a href="/pr/pr/tech/figma_dev_mode.html" class="sidebar-link">figma devmode</a></li><li><a href="/pr/pr/tech/figma_2_code.html" class="sidebar-link">figma导出代码</a></li><li><a href="/pr/pr/tech/ts-trick.html" class="sidebar-link">TS抽取组件描述</a></li><li><a href="/pr/pr/tech/typescript.html" aria-current="page" class="active sidebar-link">typescript 巧技</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pr/pr/tech/typescript.html#一些好用的工具" class="sidebar-link">一些好用的工具</a></li><li class="sidebar-sub-header"><a href="/pr/pr/tech/typescript.html#几个我在业务中写过的好玩的类型推断" class="sidebar-link">几个我在业务中写过的好玩的类型推断</a></li><li class="sidebar-sub-header"><a href="/pr/pr/tech/typescript.html#管道符号" class="sidebar-link">管道符号</a></li></ul></li><li><a href="/pr/pr/tech/api-loader.html" class="sidebar-link">low-code 模式下的数据接入方案</a></li><li><a href="/pr/pr/tech/google_workspace.html" class="sidebar-link">Google Workspace add-ons</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂谈</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-巧技"><a href="#typescript-巧技" class="header-anchor">#</a> typescript 巧技</h1> <h2 id="一些好用的工具"><a href="#一些好用的工具" class="header-anchor">#</a> 一些好用的工具</h2> <h3 id="playground"><a href="#playground" class="header-anchor">#</a> PlayGround</h3> <p><a href="https://www.typescriptlang.org/play?&amp;install-plugin=@type-challenges/playground-plugin#code/JYWwDg9gTgLgBAJQKYEMDG8BmUIjgcilQ3wG4AoctAGxQGc64BBMMOJADxiQDsATRsnQwAdAGFckHrxgAeAN5wa9OgDkUIJAC44dGFGA8A5nAC+APjjzKpymgg89zVgDEdQjCJdiFyhus0dPQNjCzgAXjgACjAcMABKCMtrODgiGABXKB44WT5gADdzWQB6fKLyW0oYAE8wJDgABTi6AHlMDzkAFUtIrvYuXgFEYlEJcAcZOAB+OC6AbXxYiDA6fABdOB1yVKj+zm5+RhiWnUNMJCg5xPDLFB4ambmtuGkCy-iKckwMngxgBxpIaXaKJFJKBxOZarHTNFZtDqjWQsMC9KymCipdJZHLI1xWESE6F0UxwErmCimIA" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/play<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
方便快速编写一个 TS 类型测试的站点，不过一般在 vscode 也都能做。它的强处在于写完代码之后它会将代码 base64 化放到 url search 参数里，你可以复制链接分享给其他人直接打开并阅读你的代码</p> <h3 id="ts-类型挑战"><a href="#ts-类型挑战" class="header-anchor">#</a> ts 类型挑战</h3> <p><a href="https://www.typescriptlang.org/play?ssl=26&amp;ssc=22&amp;pln=1&amp;pc=1&amp;install-plugin=@type-challenges/playground-plugin#code/CYUwxgNghgTiAEkoGdnwKIDcQDsAu6AtgJZ54gwA8AKvCAB7k7BoBK4A9jMJcnjMRwBzADTwoOAJ4A+afADeAKHjwOOAFzxKAaTqNcLeAGsQkjgDN41aQAoQ2fADkohEJu1jzG+DeBQ8UJrUANraALoAlPAAvHKYHMTAUbHw8YkA3Mp0JHiaOnpMhiZmltZ2DnjOru5ifgFBoZExcQnAmQC+il14kgAOCFi4eACyUL29gkIxClkA5ACuvXUgs5p8AsKZKrNwEBxQwKsK8HjE1fA484QARhTwnSrBxZoABovLAHQ4HKAfACTydaTdovMKaeTwRJrfiTe4dLpIVDwAASHD4kMIvQgIFc+DQg3wRFI5CoBJGYwmwjkShUak0ZKJZAolDJo3Gk2kwVmalmYWmNhwLhAnhwyWpWRUYDUyA42I+eyEAqFIoiW3uWRxpHpFUZJJZFTZlKEnNmmrwvP5gtctX8UDFMxUkulspA8o4iqtwvgdTtas6nUUUpw6IAFmi8NMcCAAO4o8OZRRhvgfNQ2BZLfyu76-ACMszEvlt9vk7QiXSTeA+ZrTUFr+YUpfSQA" target="_blank" rel="noopener noreferrer">https://www.typescriptlang.org/play?ssl=26&amp;ssc=22&amp;pln=1&amp;pc=1&amp;install-plugin=@type-challenges/playground-plugin#code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
一些社区给的题目，可以在 playground 中直接编写测试，直到 WebIDE 不报错位置。分 easy/medium/hard/extreme 等级别。大部分 easy 能做出来，medium 都没几道能做出来的，hard/extreme 的就不敢看了
**据说 typescript 是图灵完备，搜了一下图灵完备，发现了个好东西 **<a href="https://zh.m.wikipedia.org/zh-hans/Brainfuck" target="_blank" rel="noopener noreferrer"><strong>https://zh.m.wikipedia.org/zh-hans/Brainfuck</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="ts-类型编程库"><a href="#ts-类型编程库" class="header-anchor">#</a> ts 类型编程库</h3> <p><a href="https://github.com/millsp/ts-toolbelt" target="_blank" rel="noopener noreferrer">https://github.com/millsp/ts-toolbelt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/piotrwitek/utility-types" target="_blank" rel="noopener noreferrer">https://github.com/piotrwitek/utility-types<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/andnp/SimplyTyped" target="_blank" rel="noopener noreferrer">https://github.com/andnp/SimplyTyped<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
能想得到的类型推断方法，在这些类型工具库里都能找得到，可以节省很多写 ts 类型推断的时间。而且由于 ts 是不会带到运行环境的，所以它对项目的影响几乎是 0，只会带来正面作用。
比如一个例子：
给定一个数据，要过滤掉里面的字符串 <a href="https://codesandbox.io/s/ts-toolbelt-x4jly?file=/src/index.ts" target="_blank" rel="noopener noreferrer">https://codesandbox.io/s/ts-toolbelt-x4jly?file=/src/index.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <img src="/yuque/0/2022/png/139763/1655731025301-4356a297-b7f6-436d-bc86-106b7be7b8f5.png" alt="image.png"></p> <h2 id="几个我在业务中写过的好玩的类型推断"><a href="#几个我在业务中写过的好玩的类型推断" class="header-anchor">#</a> 几个我在业务中写过的好玩的类型推断</h2> <h3 id="推测-react-组件的props类型"><a href="#推测-react-组件的props类型" class="header-anchor">#</a> 推测 React 组件的Props类型</h3> <p>写 react 组件的时候，如果遇到了一个 npm 包或者其他人写的组件，它的 Props 声明是没有对外暴露的，而我们又有场景用到 const props: 「组件参数类型」={ } ，来加以对 props 做类型校验以防写错或者获得其对应的 ts 声明提示</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span><span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">const</span> AppFn<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span><span class="token punctuation">{</span>className<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>prop<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>


<span class="token keyword">type</span> <span class="token class-name">PropsOfReact<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component <span class="token operator">?</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token string">'props'</span><span class="token punctuation">]</span> <span class="token operator">:</span> 
  <span class="token punctuation">(</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>props<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> React<span class="token punctuation">.</span>Element <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> props<span class="token operator">:</span> PropsOfReact<span class="token operator">&lt;</span>App<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> props2<span class="token operator">:</span> PropsOfReact<span class="token operator">&lt;</span>AppFn<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>AppF <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="推测字符串"><a href="#推测字符串" class="header-anchor">#</a> 推测字符串</h3> <p>给定一个字符串，指出它的位于字符串中特定位置的严格 string 类型。比如传入一个 url , 将其解析为 protocol 、domain、pathname 几部分</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">PathName<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">infer</span> <span class="token constant">P</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">infer</span> <span class="token constant">D</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">infer</span> <span class="token constant">N</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token operator">?</span> <span class="token punctuation">{</span>protocol<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">,</span> domain<span class="token operator">:</span> <span class="token constant">D</span><span class="token punctuation">,</span> pathname<span class="token operator">:</span> <span class="token constant">N</span><span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://qq.com/somepath'</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Parts</span> <span class="token operator">=</span> PathName<span class="token operator">&lt;</span><span class="token keyword">typeof</span> url<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">// error: Type '&quot;&quot;' is not assignable to type '&quot;https&quot;'.(2322)                      </span>
<span class="token keyword">const</span> protocol<span class="token operator">:</span> Parts<span class="token punctuation">[</span><span class="token string">'protocol'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="props参数部分可选"><a href="#props参数部分可选" class="header-anchor">#</a> Props参数部分可选</h3> <p>声明一个类型，使它将传入的 Record 类型被定义为指定的部分参数可选，剩余参数是必填的。反过来也是一样的</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ExcludeFrom<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PartialRequired<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">X</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">X</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">Y</span> <span class="token keyword">in</span> ExcludeFrom<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">Y</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">SomeObj</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">,</span>
  d<span class="token operator">:</span> <span class="token string">'xxx'</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">SubObj2</span> <span class="token operator">=</span> PartialRequired<span class="token operator">&lt;</span>SomeObj<span class="token punctuation">,</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'d'</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">/**
*
type SubObj2 = {
    a?: string | undefined;
    d?: &quot;xxx&quot; | undefined;
} &amp; {
    b: number;
    c: Function;
}
*/</span>
</code></pre></div><h2 id="管道符号"><a href="#管道符号" class="header-anchor">#</a> 管道符号</h2> <p>例如 rxjs 的管道操作符。要求严格校验管道的每个节点的输入输出，并且对最后的输出能够是最后一个节点的输出类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Subject<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token generic-function"><span class="token function">pipe</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token generic-function"><span class="token function">pipe</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> b<span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> PipeNode<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token function">pipe</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">emit</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">PipeNode<span class="token operator">&lt;</span><span class="token constant">IN</span><span class="token punctuation">,</span> <span class="token constant">OUT</span><span class="token operator">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">Subject<span class="token operator">&lt;</span><span class="token constant">OUT</span><span class="token operator">&gt;</span></span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> create <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">IN</span><span class="token punctuation">,</span> <span class="token constant">OUT</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PipeNode<span class="token operator">&lt;</span><span class="token constant">IN</span><span class="token punctuation">,</span> <span class="token constant">OUT</span><span class="token operator">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 仍然声明输入输出泛型，并由具体的 handler 来推断真实类型</span>
<span class="token keyword">const</span> pipeMap <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">IN</span><span class="token punctuation">,</span> <span class="token constant">OUT</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token constant">IN</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">OUT</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PipeNode<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">IN</span><span class="token punctuation">,</span> <span class="token constant">OUT</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> s1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
  <span class="token comment">// x is number</span>
  <span class="token function">pipeMap</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">String</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// y is string</span>
  <span class="token function">pipeMap</span><span class="token punctuation">(</span>y <span class="token operator">=&gt;</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// z is boolean</span>
  <span class="token function">pipeMap</span><span class="token punctuation">(</span>z <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>z<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// v is {z: boolean}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="事件名与回调描述"><a href="#事件名与回调描述" class="header-anchor">#</a> 事件名与回调描述</h3> <p>给定一组 Mapping，key 是枚举的 string, value  是特定的值。要求 EventEmitter 能够给出相应的报警/提示，告知可触发/监听什么名称的事件，对应激发的 payload 是什么类型、得到的回调拿到的 payload 是什么类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">EventEmitter<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;&gt;</span></span> <span class="token punctuation">{</span>
  on<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>eventName<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">,</span> <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  emit<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>eventName<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">type</span> <span class="token class-name">EventMapping</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'update'</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token string-property property">'reload'</span><span class="token operator">:</span> <span class="token punctuation">{</span> time<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">update.node.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">string</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Host</span> <span class="token keyword">implements</span> <span class="token class-name">EventEmitter<span class="token operator">&lt;</span>EventMapping<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  on<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span>EventMapping<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">'on'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> fn<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  emit<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span>EventMapping<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">'emit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> host <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Host</span><span class="token punctuation">;</span>


host<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'update.node.1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">// data is {id: string}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// error Argument of type '&quot;aaa&quot;' is not assignable to parameter of type 'keyof EventMapping'.ts(2345)</span>
host<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span>

<span class="token comment">// error Argument of type '{}' is not assignable to parameter of type 'string'.ts(2345)</span>
host<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// correct</span>
host<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="从-record-中抽取所有方法"><a href="#从-record-中抽取所有方法" class="header-anchor">#</a> 从 Record 中抽取所有方法</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// 提取一个对象里所有 set 方法</span>
<span class="token keyword">type</span> <span class="token class-name">FuncPropOf<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> object<span class="token punctuation">,</span> <span class="token function-variable function">V</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">V</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span>
    <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">set</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">string</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">?</span> <span class="token constant">K</span> <span class="token operator">:</span> <span class="token builtin">never</span>
  <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 提取所有非函数属性</span>
<span class="token keyword">type</span> <span class="token class-name">NotFuncPropOf<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> object<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">K</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="从-record-中抽取所有-value-是某类型的-key"><a href="#从-record-中抽取所有-value-是某类型的-key" class="header-anchor">#</a> 从 Record 中抽取所有 Value 是某类型的 key</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code>
<span class="token keyword">type</span> <span class="token class-name">PickByValue<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> ValueType<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Key <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span>Key<span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">ValueType</span> <span class="token operator">?</span> Key <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pr/pr/tech/ts-trick.html" class="prev">
        TS抽取组件描述
      </a></span> <span class="next"><a href="/pr/pr/tech/api-loader.html">
        low-code 模式下的数据接入方案
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/pr/assets/js/app.b34ec94f.js" defer></script><script src="/pr/assets/js/2.846b7fc6.js" defer></script><script src="/pr/assets/js/1.bc703a74.js" defer></script><script src="/pr/assets/js/49.4dec6231.js" defer></script>
  </body>
</html>
